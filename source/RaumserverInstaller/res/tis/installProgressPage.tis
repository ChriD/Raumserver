
/**
*
*/
namespace InstallProgressPage
{        
  
    function init() 
    {         
       // TODO          
    }


    function pageActivated(_parmObject)
    {
        // get selected device
        $(#userInfoOutput).content("Selected Device Id: " + vlist.tbody.currentIndex.toString());
        $(#installProgressInfoOutputContainer).content("");  

        // user has clicked "install" or "update"
        startInstall() // TODO: test!!!
    }


    function checkDevice(_index)
    {
        if(_index < 0)
        {
            $(#userInfoOutput).content("No device selected");
            // TODO: Error output
            return false;
        }

        //deviceInformationList[vlist.tbody.currentIndex].ip
        return true;
    }


    function startInstall()
    {
        // TODO: check if device is ok for accessing with ssh and sftp
        if(checkDevice(vlist.tbody.currentIndex))
            view.startInstallOnDevice(deviceInformationList[vlist.tbody.currentIndex].ip);
    }


    function startUpdate()
    {
        // TODO: check if device is ok for accessing with ssh and sftp
        if(checkDevice(vlist.tbody.currentIndex))
            view.startInstallOnDevice(deviceInformationList[vlist.tbody.currentIndex].ip);
    }


    function startRemove()
    {
        // TODO: check if device is ok for accessing with ssh and sftp
        if(checkDevice(vlist.tbody.currentIndex))
            view.startRemoveFromDevice(deviceInformationList[vlist.tbody.currentIndex].ip);
    }


    function addProgressInfo(_progressInfo)
    {
        var progressInfoJsonsObject = parseData(_progressInfo.toString());
        var progressInfoArray = progressInfoJsonsObject.propertyAt("progressInfo");
         
        var info = progressInfoArray.propertyAt("info");             
        var percentage = progressInfoArray.propertyAt("percentage"); 
        var error = progressInfoArray.propertyAt("error");       

        $(#installProgressInfoOutputContainer).append(info.toString() + "<br>");    
    }


    function installationDone(_progressInfo)
    {
        $(#userInfoOutput).content("Installation done: " + _progressInfo.toString());
    }

 }
