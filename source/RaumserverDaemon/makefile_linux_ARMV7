# Makefile template for shared library

INCPATH = -I includes/ -I ../../../RaumkernelLib/source/includes/ -I ../../../RaumserverLib/source/includes/

CC = arm-linux-gnueabihf-g++-4.8
CXX = arm-linux-gnueabihf-g++-4.8
CFLAGS = -std=c++0x -fPIC -Wall -Wno-unknown-pragmas -Wno-unused-parameter -Wextra -O2 -c -pthread $(INCPATH)
CXXFLAGS = -std=c++0x -fPIC -Wall -Wno-unknown-pragmas -Wno-unused-parameter -Wextra -O2 -c -pthread $(INCPATH)
LDFLAGS = -Wl,--no-as-needed -shared -pthread -static-libgcc -static-libstdc++ -ldl

#LIBSDEF =  libs/linux_ARMV7/raumkernel.so libs/linux_ARMV7/raumserver.so
LIBSDEF =  ../../../RaumkernelLib/source/libs/linux_ARMV7/raumkernel.so ../../../RaumserverLib/source/libs/linux_ARMV7/raumserver.so

RM = rm -f 
TARGET_EXEC = raumserverDaemon

SRCS = $(wildcard *.cpp)


OBJS = $(SRCS:.cpp=.o)

#.PHONY: test
#test: $(SRCS)
#	$(CC) -o $(TARGET_EXEC) $(SRCS) -shared -fPIC -Wall -Wextra -O2


.PHONY: all
all: ${TARGET_EXEC}

$(TARGET_EXEC): $(OBJS)
	$(CC) ${LDFLAGS} -o $@ $^ $(LIBSDEF)

$(SRCS:.cpp=.d):%.d:%.cpp
	$(CC) $(CFLAGS) -MM $< >$@

include $(SRCS:.cpp=.d)


.PHONY: clean
clean:
	-${RM} ${TARGET_EXEC} ${OBJS} $(SRCS:.cpp=.d) 